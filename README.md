# Система расчета квартплаты

## Описание проекта

Система расчета квартплаты предназначена для управления данными о домах, квартирах, счетчиках воды и тарифах.
Она позволяет рассчитывать квартплату для всех квартир в доме на основе показаний счетчиков и тарифов.
Проект использует Django в качестве фреймворка веб-приложений, Celery для фоновой обработки задач и PostgreSQL в качестве базы данных.

## Модели данных

Проект реализует следующие модели данных:

- **Дом**: Модель, представляющая дом, в котором могут находиться несколько квартир.
- **Квартира**: Модель, представляющая квартиру в доме.
- **Счетчик воды**: Модель, представляющая счетчик воды, который хранит показания за несколько месяцев.
- **Тариф**: Модель, представляющая цены на тарифы, используемые для расчета коммунальных услуг.

## API

Система предоставляет API для выполнения следующих операций:

1. **Ввод и вывод данных по дому**:
   - Подключение новых домов и квартир.
   - Получение информации о доме, включая адрес и список квартир.
   - Получение информации о квартире, включая показания счетчиков воды.

2. **Расчет квартплаты**:
   - Функция для расчета квартплаты для всех квартир в доме за период.
   - Водоснабжение рассчитывается на основе разницы между показаниями счетчика за текущий и предыдущий период.
   - Содержание общего имущества рассчитывается на основе площади квартиры.

3. **Запуск расчета в фоновом режиме**:
   - API для запуска процесса расчета квартплаты с использованием Celery.
   - Если месячный платеж равен нулю, выполняется первичный расчет, включая расчеты по счетчикам воды и платежи за содержание общего имущества.
     Если месячный платеж уже начислен, выполняется перерасчет, который включает только платежи по счетчикам воды.

## Установка и настройка

Для запуска проекта необходимо:

1. **Клонируйте репозиторий:**
   git clone git@github.com:nataliadudina/Housing_Utilities.git
   cd Housing_Utilities

2. **Установите зависимости:**
   poetry install

3. **Настройте базу данных PostgreSQL:**
   - Создайте базу данных и пользователя.
   - Обновите настройки подключения к базе данных.

4. **Создайте файл `.env` в корневой директории проекта и добавьте необходимые переменные окружения.**
   Пример содержимого файла `.env` можно найти в `.env.sample`.

5. **Примените миграции:**
   python manage.py migrate

6. **Запустите проект:**
   python manage.py runserver

7. **Запустите Redis:**
   sudo service redis-server start

8. **Запустите Celery:**
   celery -A <proj-name> worker --loglevel=info

### Технологический стек

- **Python**
- **Django**
- **Django REST Framework**
- **PostgreSQL**
- **Celery**